<!doctype html>
<html lang="sv">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="default" />
<meta name="mobile-web-app-capable" content="yes" />
<meta name="theme-color" content="#ffffff" />
<title>LocalSport v12 ‚Äì Sorting & Series View</title>

<style>
:root{
  --topbar-h:56px;
  --hint-h:26px;
  --hair:#e2e8f0;
  --bg:#f0f3f8;
  --card:#fff;
  --text:#0f172a;
  --muted:#64748b;
  --accent:#16a34a;
  --link:#2563eb;
}
*{box-sizing:border-box}
html,body{
  margin:0;padding:0;height:100%;
  background:var(--bg);
  font-family:-apple-system,BlinkMacSystemFont,Roboto,Arial,Helvetica,sans-serif;
  color:var(--text);
  overscroll-behavior:none;
}

.device{
  width:100%;
  height:100dvh;
  overflow:hidden;
  display:flex;
  flex-direction:column;
}

/* TOP BAR ---------------------------------------------------------*/
.topbar{
  position:sticky;
  top:0;
  z-index:500;
  background:#fff;
  border-bottom:1px solid var(--hair);
}
.topbar-inner{
  display:grid;
  grid-template-columns:1fr auto 1fr;
  align-items:center;
  gap:6px;
  padding:6px 8px;
  height:var(--topbar-h);
}

.cluster-left,.cluster-right{
  display:flex;
  align-items:center;
  gap:8px;
}
.cluster-center{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:8px;
}

.icon-btn{
  width:32px;height:32px;
  display:grid;place-items:center;
  border-radius:10px;
  border:1px solid var(--hair);
  background:#f1f5f9;
  color:var(--text);
}
.date-block{
  display:flex;
  flex-direction:column;
  align-items:center;
  line-height:1.1;
  font-weight:700;
  font-size:14px;
}

/* SORTING BUTTON STACK */
.sort-stack{
  transform:scale(.9);
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:4px 6px;
  border:1px solid var(--hair);
  border-radius:10px;
  background:#fff;
  box-shadow:0 1px 2px rgba(0,0,0,.04)
}
.sort-top{font-size:12px;font-weight:600;margin-bottom:2px;text-align:center}
.sort-bottom{display:flex;gap:4px}
.pill{padding:4px 8px;border-radius:999px;font-size:11px;font-weight:600;border:1px solid var(--hair);cursor:pointer;user-select:none}
.pill.on{background:#dcfce7;color:var(--accent);border-color:#86efac}
.pill.off{background:#f1f5f9;color:#94a3b8;border-color:#cbd5e1}

/* HINT ------------------------------------------------------------*/
.hint{
  position:sticky;
  top:var(--topbar-h);
  z-index:450;
  color:var(--muted);
  font-size:12px;
  text-align:center;
  line-height:var(--hint-h);
  height:var(--hint-h);
  background:#fff;
  border-bottom:1px solid var(--hair);
}

/* STICKY ARENA HEADER (ONLY IN LOCATION MODE) ---------------------*/
.group-slot{
  position:sticky;
  top:calc(var(--topbar-h) + var(--hint-h));
  z-index:425;
  height:42px;
  background:#fff;
  border-bottom:1px dashed var(--hair);
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:10px 12px;
  font-weight:700;
}

/* SCROLLABLE GAME LIST --------------------------------------------*/
.scroll{
  flex:1;
  overflow-y:auto;
  -webkit-overflow-scrolling:touch;
  background:var(--bg);
  padding:0;margin:0;width:100%;
}

.arena{
  margin:0 0 10px 0;
  width:100%;
  border:1px solid var(--hair);
  border-radius:0 0 14px 14px;
  background:var(--card);
  box-shadow:0 2px 6px rgba(0,0,0,.05);
  overflow:hidden;
}

.games{display:block}

/* GAME CARD --------------------------------------------------------*/
.game{
  padding:8px 12px;
  border-top:1px dashed #e5e7eb;
  background:#fff;
  width:100%;
  display:grid;
  gap:6px;
}
.game-top{
  display:grid;
  grid-template-columns: 1fr auto auto;
  gap:6px;
  align-items:center;
}
.game-time{font-weight:700}
.game-series a{color:var(--link);text-decoration:none;font-weight:600}

.game-mid{font-weight:700;text-align:center}
.game-right{font-size:12px;color:var(--muted);text-align:right}

.game-bottom{
  display:grid;
  grid-template-columns:1fr auto 1fr;
  align-items:center;
  gap:6px;
}
.team{display:inline-flex;align-items:center;gap:6px;font-weight:600}
.team.right{text-align:left;justify-self:start}
.team-logo{
  width:26px;height:26px;border-radius:50%;
  border:1px solid var(--hair);
  object-fit:cover;background:#f1f5f9;
}
.team-name{
  max-width:min(35vw,160px);
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  font-size:clamp(10px,2.5vw,13px);
}
.result a{
  display:inline-flex;justify-content:center;align-items:center;
  min-width:72px;height:26px;
  padding:0 8px;border-radius:8px;
  border:1px solid var(--hair);
  background:#f1f5f9;color:var(--text);
  font-weight:700;
  text-decoration:none;
  text-align:center;
}

.divider{
  height:8px;
  background:var(--bg);
  border-top:1px dashed var(--hair);
}

@media(min-width:768px){.device{max-width:720px;margin:auto}}
@media(min-width:1024px){.device{max-width:840px}}
</style>
</head>

<body>
<div class="device">

<header class="topbar">
  <div class="topbar-inner">
    <div class="cluster-left">
      <button class="icon-btn">üè†</button><button class="icon-btn">üó∫Ô∏è</button>
    </div>
    <div class="cluster-center">
      <button class="icon-btn" id="btnPrev">‚óÄ</button>
      <div class="date-block"><span>Idag</span><span>Tors</span><span>23 okt</span></div>
      <button class="icon-btn" id="btnNext">‚ñ∂</button>
    </div>
    <div class="cluster-right">
      <div class="sort-stack">
        <div class="sort-top">Sortering</div>
        <div class="sort-bottom">
          <span id="sortPlace" class="pill on">Plats</span>
          <span id="sortSeries" class="pill off">Serie</span>
          <span id="sortTime" class="pill off">Tid</span>
        </div>
      </div>
      <button class="icon-btn">‚öôÔ∏è</button>
    </div>
  </div>
</header>

<div class="hint">Visar matcher n√§ra: Kruniusv√§gen 1, Billdal (57.590214, 11.946082)</div>

<div class="group-slot" id="groupSlot">Kungsbacka Ishall A<span>Avst 8 km</span></div>

<main class="scroll" id="scrollArea">

<!-- ARENA 1 ‚Äî 5 MATCHER -->
<section class="arena" data-arena="Kungsbacka Ishall A" data-distance="8">
<div class="games">

<!-- MATCH 1 -->
<article class="game">
  <div class="game-top">
    <div class="game-time">09:00</div>
    <div class="game-series"><a href="#">HockeyTv√•an S√∂dra</a></div>
  </div>
  <div class="game-bottom">
    <div class="team"><img class="team-logo" src="logos/Hanhals_IF__b65395a8-4623-46e4-96ab-97ff2e0e7b72.png"><span class="team-name">Hanhals IF</span></div>
    <div class="result"><a href="#">‚Äì</a></div>
    <div class="team right"><img class="team-logo" src="logos/B√§cken_HC__119055af-fc61-4108-82a8-a0cd0e883df0.png"><span class="team-name">B√§cken HC</span></div>
  </div>
</article>

<!-- MATCH 2 -->
<article class="game">
  <div class="game-top">
    <div class="game-time">10:00</div>
    <div class="game-series"><a href="#">J18 Region Syd</a></div>
  </div>
  <div class="game-bottom">
    <div class="team"><img class="team-logo" src="logos/Gr√§storps_IK__c6811c5f-e2c9-43e2-a9c2-73ab53f63fd1.png"><span class="team-name">Gr√§storps IK</span></div>
    <div class="result"><a href="#">2 - 1</a></div>
    <div class="team right"><img class="team-logo" src="logos/Kung√§lvs_IK__620a9df2-1b0b-4bc5-b9eb-7e88670f4c7b.png"><span class="team-name">Kung√§lvs IK</span></div>
  </div>
</article>

<!-- MATCH 3 -->
<article class="game">
  <div class="game-top">
    <div class="game-time">12:20</div>
    <div class="game-series"><a href="#">J20 Region Syd</a></div>
  </div>
  <div class="game-bottom">
    <div class="team"><img class="team-logo" src="logos/B√§cken_HC__119055af-fc61-4108-82a8-a0cd0e883df0.png"><span class="team-name">B√§cken HC</span></div>
    <div class="result"><a href="#">3 - 5</a></div>
    <div class="team right"><img class="team-logo" src="logos/Hanhals_IF__b65395a8-4623-46e4-96ab-97ff2e0e7b72.png"><span class="team-name">Hanhals IF</span></div>
  </div>
</article>

<!-- MATCH 4 -->
<article class="game">
  <div class="game-top">
    <div class="game-time">15:10</div>
    <div class="game-series"><a href="#">Tr√§ningsmatch</a></div>
  </div>
  <div class="game-bottom">
    <div class="team"><img class="team-logo" src="logos/Kung√§lvs_IK__620a9df2-1b0b-4bc5-b9eb-7e88670f4c7b.png"><span class="team-name">Kung√§lvs IK</span></div>
    <div class="result"><a href="#">‚Äì</a></div>
    <div class="team right"><img class="team-logo" src="logos/Gr√§storps_IK__c6811c5f-e2c9-43e2-a9c2-73ab53f63fd1.png"><span class="team-name">Gr√§storps IK</span></div>
  </div>
</article>

<!-- MATCH 5 -->
<article class="game">
  <div class="game-top">
    <div class="game-time">18:20</div>
    <div class="game-series"><a href="#">HockeyTv√•an S√∂dra</a></div>
  </div>
  <div class="game-bottom">
    <div class="team"><img class="team-logo" src="logos/B√§cken_HC__119055af-fc61-4108-82a8-a0cd0e883df0.png"><span class="team-name">B√§cken HC</span></div>
    <div class="result"><a href="#">1 - 0</a></div>
    <div class="team right"><img class="team-logo" src="logos/Hanhals_IF__b65395a8-4623-46e4-96ab-97ff2e0e7b72.png"><span class="team-name">Hanhals IF</span></div>
  </div>
</article>

</div>
</section>

<!-- ARENA 2 ‚Äî 10 MATCHER -->
<section class="arena" data-arena="√Öse & Viste Arena" data-distance="72">
<div class="games">

<article class="game"><div class="game-top"><div class="game-time">09:00</div><div class="game-series"><a href="#">HockeyTv√•an S√∂dra</a></div></div><div class="game-bottom"><div class="team"><img class="team-logo" src="logos/Gr√§storps_IK__c6811c5f-e2c9-43e2-a9c2-73ab53f63fd1.png"><span class="team-name">Gr√§storps IK</span></div><div class="result"><a href="#">2 - 2</a></div><div class="team right"><img class="team-logo" src="logos/B√§cken_HC__119055af-fc61-4108-82a8-a0cd0e883df0.png"><span class="team-name">B√§cken HC</span></div></div></article>

<article class="game"><div class="game-top"><div class="game-time">10:00</div><div class="game-series"><a href="#">J18 Region Syd</a></div></div><div class="game-bottom"><div class="team"><img class="team-logo" src="logos/Kung√§lvs_IK__620a9df2-1b0b-4bc5-b9eb-7e88670f4c7b.png"><span class="team-name">Kung√§lvs IK</span></div><div class="result"><a href="#">0 - 3</a></div><div class="team right"><img class="team-logo" src="logos/Hanhals_IF__b65395a8-4623-46e4-96ab-97ff2e0e7b72.png"><span class="team-name">Hanhals IF</span></div></div></article>

<article class="game"><div class="game-top"><div class="game-time">11:30</div><div class="game-series"><a href="#">J20 Region Syd</a></div></div><div class="game-bottom"><div class="team"><img class="team-logo" src="logos/Hanhals_IF__b65395a8-4623-46e4-96ab-97ff2e0e7b72.png"><span class="team-name">Hanhals IF</span></div><div class="result"><a href="#">‚Äì</a></div><div class="team right"><img class="team-logo" src="logos/Kung√§lvs_IK__620a9df2-1b0b-4bc5-b9eb-7e88670f4c7b.png"><span class="team-name">Kung√§lvs IK</span></div></div></article>

<article class="game"><div class="game-top"><div class="game-time">12:45</div><div class="game-series"><a href="#">Tr√§ningsmatch</a></div></div><div class="game-bottom"><div class="team"><img class="team-logo" src="logos/B√§cken_HC__119055af-fc61-4108-82a8-a0cd0e883df0.png"><span class="team-name">B√§cken HC</span></div><div class="result"><a href="#">3 - 1</a></div><div class="team right"><img class="team-logo" src="logos/Gr√§storps_IK__c6811c5f-e2c9-43e2-a9c2-73ab53f63fd1.png"><span class="team-name">Gr√§storps IK</span></div></div></article>

<article class="game"><div class="game-top"><div class="game-time">14:30</div><div class="game-series"><a href="#">HockeyTv√•an S√∂dra</a></div></div><div class="game-bottom"><div class="team"><img class="team-logo" src="logos/Kung√§lvs_IK__620a9df2-1b0b-4bc5-b9eb-7e88670f4c7b.png"><span class="team-name">Kung√§lvs IK</span></div><div class="result"><a href="#">‚Äì</a></div><div class="team right"><img class="team-logo" src="logos/Hanhals_IF__b65395a8-4623-46e4-96ab-97ff2e0e7b72.png"><span class="team-name">Hanhals IF</span></div></div></article>

<article class="game"><div class="game-top"><div class="game-time">15:50</div><div class="game-series"><a href="#">J18 Region Syd</a></div></div><div class="game-bottom"><div class="team"><img class="team-logo" src="logos/Gr√§storps_IK__c6811c5f-e2c9-43e2-a9c2-73ab53f63fd1.png"><span class="team-name">Gr√§storps IK</span></div><div class="result"><a href="#">0 - 0</a></div><div class="team right"><img class="team-logo" src="logos/Hanhals_IF__b65395a8-4623-46e4-96ab-97ff2e0e7b72.png"><span class="team-name">Hanhals IF</span></div></div></article>

<article class="game"><div class="game-top"><div class="game-time">16:40</div><div class="game-series"><a href="#">J20 Region Syd</a></div></div><div class="game-bottom"><div class="team"><img class="team-logo" src="logos/B√§cken_HC__119055af-fc61-4108-82a8-a0cd0e883df0.png"><span class="team-name">B√§cken HC</span></div><div class="result"><a href="#">1 - 4</a></div><div class="team right"><img class="team-logo" src="logos/Kung√§lvs_IK__620a9df2-1b0b-4bc5-b9eb-7e88670f4c7b.png"><span class="team-name">Kung√§lvs IK</span></div></div></article>

<article class="game"><div class="game-top"><div class="game-time">17:40</div><div class="game-series"><a href="#">HockeyTv√•an S√∂dra</a></div></div><div class="game-bottom"><div class="team"><img class="team-logo" src="logos/Hanhals_IF__b65395a8-4623-46e4-96ab-97ff2e0e7b72.png"><span class="team-name">Hanhals IF</span></div><div class="result"><a href="#">6 - 2</a></div><div class="team right"><img class="team-logo" src="logos/B√§cken_HC__119055af-fc61-4108-82a8-a0cd0e883df0.png"><span class="team-name">B√§cken HC</span></div></div></article>

<article class="game"><div class="game-top"><div class="game-time">18:20</div><div class="game-series"><a href="#">Tr√§ningsmatch</a></div></div><div class="game-bottom"><div class="team"><img class="team-logo" src="logos/Kung√§lvs_IK__620a9df2-1b0b-4bc5-b9eb-7e88670f4c7b.png"><span class="team-name">Kung√§lvs IK</span></div><div class="result"><a href="#">‚Äì</a></div><div class="team right"><img class="team-logo" src="logos/Gr√§storps_IK__c6811c5f-e2c9-43e2-a9c2-73ab53f63fd1.png"><span class="team-name">Gr√§storps IK</span></div></div></article>

<article class="game"><div class="game-top"><div class="game-time">19:40</div><div class="game-series"><a href="#">J18 Region Syd</a></div></div><div class="game-bottom"><div class="team"><img class="team-logo" src="logos/B√§cken_HC__119055af-fc61-4108-82a8-a0cd0e883df0.png"><span class="team-name">B√§cken HC</span></div><div class="result"><a href="#">1 - 2</a></div><div class="team right"><img class="team-logo" src="logos/Hanhals_IF__b65395a8-4623-46e4-96ab-97ff2e0e7b72.png"><span class="team-name">Hanhals IF</span></div></div></article>

</div>
</section>
</main>

</div>

<script>
const MODE = { PLACE:1, SERIES:2, SERIES_TIME:3 };
let currentMode = MODE.PLACE;

// DOM
const scroll = document.getElementById("scrollArea");
const groupSlot = document.getElementById("groupSlot");
const btnPlace = document.getElementById("sortPlace");
const btnSeries = document.getElementById("sortSeries");
const btnTime = document.getElementById("sortTime");

// Helper
function parseTime(t){return parseInt(t.replace(":",""),10);}
function km(arena){return parseInt(document.querySelector(`[data-arena='${arena}']`)?.dataset.distance || 0,10);}

// Priority logic (simplified)
function seriesPriority(s){
  if (s.includes("HockeyTv√•an")) return 10;
  if (s.includes("J20")) return 20;
  if (s.includes("J18")) return 30;
  if (s.includes("Tr√§nings")) return 40;
  return 999;
}

function render(){
  scroll.innerHTML = "";
  const games = Array.from(document.querySelectorAll(".game"));

  // Extract game metadata
  const data = games.map(g => {
    const arenaEl = g.closest(".arena");
    return {
      elem:g,
      arena: arenaEl.dataset.arena,
      dist: parseInt(arenaEl.dataset.distance),
      time: parseTime(g.querySelector(".game-time").textContent.trim()),
      series: g.querySelector(".game-series").textContent.trim()
    };
  });

  let groups = {};

  if (currentMode === MODE.PLACE){
    groupSlot.style.display="flex";
    btnTime.classList.add("on");
    btnTime.classList.remove("off");
    data.forEach(g=>{
      (groups[g.arena] ||= []).push(g);
    });
    Object.entries(groups)
      .sort((a,b)=> a[1][0].dist - b[1][0].dist)
      .forEach(([arena,glist])=>{
        groupSlot.firstChild.textContent = arena;
        groupSlot.lastChild.textContent = `Avst ${km(arena)} km`;
        glist.sort((a,b)=> a.time - b.time);
        glist.forEach(g=> scroll.appendChild(g.elem));
      });

  } else {
    groupSlot.style.display="none";
    data.forEach(g=>{
      (groups[g.series] ||= []).push(g);
    });

    let sortedSeries = Object.entries(groups).sort(
      (a,b)=> seriesPriority(a[0]) - seriesPriority(b[0])
    );

    sortedSeries.forEach(([series,glist], index)=>{
      if(currentMode === MODE.SERIES && index>0){
        const d=document.createElement("div");
        d.className="divider";
        scroll.appendChild(d);
      }

      if (currentMode === MODE.SERIES_TIME){
        glist.sort((a,b)=> a.time - b.time || seriesPriority(a.series) - seriesPriority(b.series));
      } else {
        glist.sort((a,b)=> seriesPriority(a.series) - seriesPriority(b.series) || a.time - b.time);
      }
      glist.forEach(g=> scroll.appendChild(g.elem));
    });
  }
}

// Event listeners
btnPlace.onclick = ()=>{
  currentMode = MODE.PLACE;
  btnPlace.classList.add("on");
  btnSeries.classList.remove("on");
  btnTime.classList.add("on");
  render();
};

btnSeries.onclick = ()=>{
  currentMode = MODE.SERIES;
  btnPlace.classList.remove("on");
  btnSeries.classList.add("on");
  btnTime.classList.remove("on");
  render();
};

btnTime.onclick = ()=>{
  if(currentMode===MODE.PLACE) return; // tid l√•st i plats-mode
  if(currentMode===MODE.SERIES){
    currentMode = MODE.SERIES_TIME;
    btnTime.classList.add("on");
  } else {
    currentMode = MODE.SERIES;
    btnTime.classList.remove("on");
  }
  render();
};

render();
</script>
</body>
</html>

