<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LocalSport ‚Äî Matcher</title>
<style>
    body { margin:0; padding:0; font-family:Arial, sans-serif; background:#fafafa; }
    .topbar {
        position:fixed; top:0; left:0; right:0; height:70px;
        background:white; border-bottom:1px solid #ccc;
        display:flex; align-items:center; justify-content:space-between;
        padding:0 12px; z-index:100;
    }
    .top-left, .top-center, .top-right { display:flex; align-items:center; gap:12px; }
    .sort-container { display:flex; flex-direction:column; text-align:center; }
    .sort-buttons { display:flex; gap:8px; margin-top:2px; }
    .sort-btn {
        padding:2px 6px; border-radius:5px; cursor:pointer; border:1px solid #777;
        font-size:12px; min-width:46px; text-align:center;
    }
    .sort-btn.on { background:#00b300; color:white; border-color:#007f00; }
    .arena-header {
        position:sticky; top:70px; background:white; z-index:50;
        padding:8px 0; font-weight:bold; text-align:center; border-bottom:1px solid #ddd;
    }
    .game {
        padding:12px; border-bottom:1px solid #eee; margin-top:0;
    }
    .game .row-top { display:flex; justify-content:space-between; font-size:14px; }
    .series-link { color:#0066cc; text-decoration:none; font-weight:bold; }
    .row-bottom {
        margin-top:6px; display:flex; align-items:center; justify-content:space-between;
    }
    .team { display:flex; align-items:center; gap:6px; }
    .team img { width:26px; height:26px; object-fit:contain; }
    .result-btn {
        padding:3px 10px; border-radius:6px;
        background:black; color:white; font-size:14px;
    }
    .result-link { color:#0077ff; font-weight:bold; cursor:pointer; }
    .content { padding-top:78px; }
</style>
</head>
<body>

<!-- ‚úÖ TOP BAR -->
<div class="topbar">
    <div class="top-left">
        <span id="home">üè†</span>
        <span id="map">üó∫Ô∏è</span>
    </div>

    <div class="top-center">
        <span id="prevDate" style="cursor:pointer;">‚¨ÖÔ∏è</span>
        <span id="relativeText"></span>
        <span id="weekday"></span>
        <span id="date"></span>
        <span id="nextDate" style="cursor:pointer;">‚û°Ô∏è</span>
    </div>

    <div class="top-right">
        <div class="sort-container">
            <span style="font-size:12px;">Sortering</span>
            <div class="sort-buttons">
                <div id="sortPlats" class="sort-btn on">Plats</div>
                <div id="sortSerie" class="sort-btn on">Serie</div>
                <div id="sortTid" class="sort-btn">Tid</div>
            </div>
        </div>
        <span id="settings">‚öôÔ∏è</span>
    </div>
</div>

<div id="content" class="content"></div>

<script>
/* ======================================================
   ‚úÖ Datumstyrning ‚Äî alltid starta p√• 26 oktober 2025
====================================================== */

const forcedStartDate = "2025-10-26";
let currentDate = new Date(forcedStartDate);

/* ‚úÖ UI Element referenser */
const dateEl = document.getElementById("date");
const weekdayEl = document.getElementById("weekday");
const relativeEl = document.getElementById("relativeText");
const content = document.getElementById("content");

/* weekday lookup */
const weekDays = ["S√∂n", "M√•n", "Tis", "Ons", "Tors", "Fre", "L√∂r"];

/* ===============================================
   ‚úÖ Ladda matcher f√∂r ett givet datum (JSON fetch)
=============================================== */
async function loadGames() {
    const y = currentDate.getFullYear();
    const m = String(currentDate.getMonth()+1).padStart(2,"0");
    const d = String(currentDate.getDate()).padStart(2,"0");
    const filename = `data/games_${y}-${m}-${d}.json`;

    console.log("üîé Loading JSON:", filename);

    try {
        const res = await fetch(filename);
        if (!res.ok) throw new Error("File not found");

        const games = await res.json();
        renderGames(games);

    } catch (err) {
        content.innerHTML = `<p style="padding:12px;color:#900;">
        ‚ùå Inga matcher hittades f√∂r ${y}-${m}-${d} (${filename})
        </p>`;
        console.error("Fetch error:", err);
    }
}

/* ===============================================
   ‚úÖ Uppdaterar datum i UI
=============================================== */
function updateDateUI() {
    dateEl.textContent = currentDate.getDate() + " okt";
    weekdayEl.textContent = weekDays[currentDate.getDay()];

    if (currentDate.toISOString().slice(0,10) === forcedStartDate) {
        relativeEl.textContent = "Idag";
    } else {
        relativeEl.textContent = "";
    }

    loadGames();
}

/* ===============================================
   ‚úÖ Rendera matcher p√• sidan
=============================================== */
function renderGames(games) {
    content.innerHTML = "";

    games.sort((a,b)=> a.distanceKm - b.distanceKm);

    let lastArena = null;

    games.forEach(game => {
        if (game.arena !== lastArena) {
            lastArena = game.arena;
            content.innerHTML += `
                <div class="arena-header">${game.arena} ‚Äî Avst√•nd ${game.distanceKm} km</div>
            `;
        }

        content.innerHTML += `
            <div class="game">
                <div class="row-top">
                    <span>${game.time}</span>
                    <a class="series-link" href="${game.linkToSeries}" target="_blank">${game.series}</a>
                </div>
                <div class="row-bottom">
                    <div class="team"><img src="logos/${game.homeLogo}">${game.homeTeam}</div>
                    ${
                        game.result === "-"
                        ? `<span class="result-btn">-</span>`
                        : `<a href="${game.resultLink}" target="_blank" class="result-link">${game.result}</a>`
                    }
                    <div class="team"><img src="logos/${game.awayLogo}">${game.awayTeam}</div>
                </div>
            </div>
        `;
    });
}

/* ===============================================
   ‚úÖ Datum navigation
=============================================== */
document.getElementById("prevDate").onclick = () => {
    currentDate.setDate(currentDate.getDate() - 1);
    updateDateUI();
};

document.getElementById("nextDate").onclick = () => {
    currentDate.setDate(currentDate.getDate() + 1);
    updateDateUI();
};

/* ===============================================
   ‚úÖ Starta sidan
=============================================== */
updateDateUI();
</script>

</body>
</html>

